<h1 id="why-pandas-">Why Pandas ?</h1>

<p>To create a machine learning model, we need to apply the underlying algorithm on some training data (more on this in <strong>Lecture 5</strong>). For this to work, we need to have a specific data structure to pass as input. <br />
Most traditional ML models require a 2D data-structure, just like a matrix. A <code class="language-plaintext highlighter-rouge">numpy.array</code> can be used for that purpose. Each row define an observation (more on this in <strong>Lecture 5</strong>), types of observations might depend on our designed problem. Each column display a caracteristic for each of these observations.<br />
Now, imagine such 2D data structure, maybe you would want to first name your columns and rows, analogously to a spreadsheet or SQL table, then inspect your data, handle missing values, do some processing on it (e.g. retrieve number of streets out of the street name), combine with other related, 2D, data from different sources, quickly perform descriptive statistics, do some computations on columns, on rows, or even within groups of observations sharing some common arbitrary caracteristic, quickly display trends from your computations.<br />
Also, dealing with initially less structured, clean and complete data, consists in most of the time spent by the data scientist. Sometimes the data you’re being given doesn’t have such 2D representation and you would want to have some helpers functions to perform the conversion.</p>

<p>In either cases, <code class="language-plaintext highlighter-rouge">Pandas</code> package and its <code class="language-plaintext highlighter-rouge">DataFrame</code> object comes in handy.</p>

<h1 id="three-important-pandas-data-structures">Three important Pandas’ data-structures</h1>

<p>From the pandas docs, which give a nice overview of the <a href="https://pandas.pydata.org/docs/getting_started/overview.html">package</a>:</p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">pandas.DataFrame</code> is a 2-dimensional labeled data structure with columns of potentially different types. You can think of it like a spreadsheet. It got rows and columns’ labels (<code class="language-plaintext highlighter-rouge">pandas.Index</code> objects). Each column is a <code class="language-plaintext highlighter-rouge">pandas.Series</code>.</p>
</blockquote>

<p>Pandas is built on top of Numpy, hence sharing some optimizations from the latter, as well as closely related API.</p>

<p>In the rest of this tutorial we will mainly work on the <code class="language-plaintext highlighter-rouge">DataFrame</code> class, although we first need to introduce the 2 other core data structures mentioned sooner: the <code class="language-plaintext highlighter-rouge">Series</code> and the <code class="language-plaintext highlighter-rouge">Index</code>, as they are each constitutive of <code class="language-plaintext highlighter-rouge">DataFrame</code> and the former share also similarly named methods and behaviors with the <code class="language-plaintext highlighter-rouge">DataFrame</code> class.</p>

<h2 id="series">Series</h2>

<h3 id="definition">Definition</h3>

<p>one-dimensional array of indexed data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0    3
1    2
2    1
dtype: int64
</code></pre></div></div>

<p>with explicit index definition !</p>

<p>Example:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie_1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">93</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span> <span class="mi">219394</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie_1</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>93        3
129       2
219394    1
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie_1</span><span class="p">.</span><span class="n">index</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Int64Index([93, 129, 219394], dtype='int64')
</code></pre></div></div>

<h3 id="series-as-a-dictionnary-like-object">Series as a dictionnary-like object</h3>

<p>A <strong>dictionnary-like</strong>, object with possible <strike>keys</strike> index repetition.<br /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">"rené"</span><span class="p">,</span> <span class="s">"rené"</span><span class="p">,</span> <span class="s">"jean"</span><span class="p">])</span>
</code></pre></div></div>

<p>We display a series.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rené    3
rené    2
jean    1
dtype: int64
</code></pre></div></div>

<p>We can show the values, a numpy typed array.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">.</span><span class="n">values</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([3, 2, 1])
</code></pre></div></div>

<p>and show the <strike>keys</strike> index !</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">.</span><span class="n">index</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['rené', 'rené', 'jean'], dtype='object')
</code></pre></div></div>

<p>Here the 4 basic <code class="language-plaintext highlighter-rouge">dict</code> operations work seamlessly the same for a <code class="language-plaintext highlighter-rouge">Series</code>.</p>

<ul>
  <li>Access by <strike>key</strike> index:</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">[</span><span class="s">'rené'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rené    3
rené    2
dtype: int64
</code></pre></div></div>

<ul>
  <li>Set a new <strike>key</strike> index:value pair</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">[</span><span class="s">'joseph'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
</code></pre></div></div>

<ul>
  <li>Change a value for a given <strike>key</strike> index.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">[</span><span class="s">'rené'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre></div></div>

<p>Notice the broadcoasting of the integer here in case of multiple same index for the given value.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rené      4
rené      4
jean      1
joseph    5
dtype: int64
</code></pre></div></div>

<p>You can also pass a sequence of elements with a <strong>matching</strong> length with the index multiplicity number.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">[</span><span class="s">'rené'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rené      4
rené      3
jean      1
joseph    5
dtype: int64
</code></pre></div></div>

<ul>
  <li>delete a <strike>key</strike> index:value pair</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">del</span> <span class="n">serie</span><span class="p">[</span><span class="s">"rené"</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jean      1
joseph    5
dtype: int64
</code></pre></div></div>

<p>You can also do lookups on indexes, using the same syntax as for <code class="language-plaintext highlighter-rouge">dict</code> keys.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">'rené'</span> <span class="ow">in</span> <span class="n">serie</span><span class="p">)</span> <span class="c1">#in the indexes, same syntax as for dict keys
</span><span class="k">print</span><span class="p">(</span><span class="s">"jean"</span> <span class="ow">in</span> <span class="n">serie</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>False
True
</code></pre></div></div>

<ul>
  <li>When index is <strong>unique</strong>, pandas use a hashtable just like <code class="language-plaintext highlighter-rouge">dict</code>s : O(1).</li>
  <li>When index is <strong>non-unique and sorted</strong>, pandas use binary search O(logN)</li>
  <li>When index is <strong>non-unique and not-sorted</strong>, pandas need to check all the keys just like a list look-up: O(N).</li>
</ul>

<p>You can also do some other things you would not be able using <code class="language-plaintext highlighter-rouge">dict</code> primitive, like slicing.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># indexing: not possible in a simple dict 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jean    1
dtype: int64
</code></pre></div></div>

<p>The similarity with <code class="language-plaintext highlighter-rouge">dict</code> is although so close you can use a <code class="language-plaintext highlighter-rouge">dict</code> in the <code class="language-plaintext highlighter-rouge">pd.Series</code> constructor. This automatically create the indexes from the keys in the <code class="language-plaintext highlighter-rouge">dict</code> and the values from the corresponding values in the <code class="language-plaintext highlighter-rouge">dict</code>.
<u>Note</u>: the index:value order in the newly created <code class="language-plaintext highlighter-rouge">pd.Series</code> can be slightly different for different concomittent versions of Python and Pandas. Pandas &gt;= 0.23 conserve the insertion order from the underlying <code class="language-plaintext highlighter-rouge">dict</code> argument, although you still Python versions above 3.6 to maintain <code class="language-plaintext highlighter-rouge">dict</code> keys’insertion order (use <code class="language-plaintext highlighter-rouge">OrderedDict</code> for versions before).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s">"ea"</span><span class="p">,</span><span class="s">"fzf"</span><span class="p">,</span><span class="s">"aeif"</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])))</span>
<span class="c1"># with zip or using a dict
</span><span class="n">test2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">({</span><span class="s">"ea"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s">"fzf"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s">"aeif"</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">"ea"</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aeif    2
ea      2
fzf     3
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test2</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ea    2
dtype: int64
</code></pre></div></div>

<p><strong>If multiple different types reside in a Series, all of the data will get upcasted to a dtype that accommodates all of the data involved.</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">({</span><span class="s">"ea"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s">"fzf"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s">"aeif"</span><span class="p">:</span><span class="s">"zf"</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">"ea"</span><span class="p">])</span>
<span class="n">test2</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ea    2
dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">({</span><span class="s">"ea"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s">"fzf"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s">"aeif"</span><span class="p">:</span><span class="mf">2.4</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">"ea"</span><span class="p">])</span>
<span class="n">test2</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ea    2.0
dtype: float64
</code></pre></div></div>

<p><strong>dtype=object</strong> means that the best common type infered representation for the contents of the <code class="language-plaintext highlighter-rouge">pd.Series</code> is “a Python object”. (Everything is object in Python see <strong>Lecture 2</strong>!).<br />
This also means a performance drop, <strong>any operations on the data will be done at the Python level</strong>. Python for-loops will be performed, checking the actual type of each ‘object’ for the operation one want to perform on the input vector (1)</p>

<h3 id="selection-in-series">Selection in Series</h3>

<h4 id="masking">Masking</h4>

<p>A Series mask is a Series as a collection of indexes:boolean-values, which can be later used to filter-out elements from another Series, based on the falsy evaluated values for each index in the former.</p>

<p>Performing a comparison on a Series creates a mask of same shape, with indexes from the original array along with <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code> results originating from the <strong>element-wise</strong> comparisons from your original comparison expression.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">test</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aeif    False
ea      False
fzf      True
dtype: bool
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">test</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aeif    True
ea      True
fzf     True
dtype: bool
</code></pre></div></div>

<p>Since numpy arrays support <strong>vectorized calculations</strong> (more on that later) and does not contain arbitrary unlike typed elements as for lists, you can use the <code class="language-plaintext highlighter-rouge">&amp;</code> bitwise operator, a element-wise version of the logical <code class="language-plaintext highlighter-rouge">and</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># not "and" but "&amp;" : &amp; operator is a bitwise "and"
</span><span class="p">(</span><span class="n">test</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> 
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aeif    False
ea      False
fzf      True
dtype: bool
</code></pre></div></div>

<p>You can see the result is still a Series, but this time of boolean values (check the <code class="language-plaintext highlighter-rouge">dtype</code> !)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">type</span><span class="p">((</span><span class="n">test</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pandas.core.series.Series
</code></pre></div></div>

<p>We can later keep it in as a ‘mask’ variable, it is particularly useful when a lot comparisons should be given a meaningful name (e.g. <code class="language-plaintext highlighter-rouge">mask</code> variable here could be <code class="language-plaintext highlighter-rouge">lower4greater2</code> for example).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># mask ( the last expression whose result is an pd.Serie stored in the variable mask)
</span><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">test</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fzf    3
dtype: int64
</code></pre></div></div>

<h4 id="indexing">Indexing</h4>

<p>We can also select a value for a given index, as highlighted in the introductory section on <code class="language-plaintext highlighter-rouge">Series</code>. 
Although we should take extra care when doing so: the previous notation, e.g. <code class="language-plaintext highlighter-rouge">serie['rené']</code>, makes use of the <strong>names</strong> of the indexes we <strong>explicitly defined</strong> earlier.</p>

<h4 id="fancy-indexing">Fancy indexing</h4>

<p>This is just a fancy word for selecting multiple indexes, provisioning a list of indexes.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># fancy indexing (&lt;=&gt; selecting multiple indexes using a list of indexes)
</span><span class="n">test</span><span class="p">[[</span><span class="s">"ea"</span><span class="p">,</span> <span class="s">"fzf"</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ea     2
fzf    3
dtype: int64
</code></pre></div></div>

<h4 id="slicing-and-the-confusion-of-explicit-vs-implicit-indexes">Slicing and the confusion of explicit vs implicit indexes</h4>

<p>This is another word for selecting a subset of an original array (or even list), based on an interval constructed using a start, stop and [step] elements.</p>

<p>For Series, we can slice a Series by 2 ways:</p>
<ul>
  <li>using the names we <strong>explicitly</strong> defined (or defaulted as integer-based indexes creation) for the index at <code class="language-plaintext highlighter-rouge">Series</code> creation time, for start and stop values.</li>
  <li>
    <p>using <strong>implicit</strong> start and stop values for the index. By implicit we mean integers which define the order of appearance of the index itself, taking caution that the first element is of index 0 in Python.</p>
  </li>
  <li>Explicit index slicing:</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#  (using the labels of the indexes)
</span><span class="n">test</span><span class="p">[</span><span class="s">"aeif"</span><span class="p">:</span> <span class="s">"fzf"</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aeif    2
ea      2
fzf     3
dtype: int64
</code></pre></div></div>

<ul>
  <li>Implicit index slicing (using integers i.e. order of appearance):</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aeif    2
ea      2
dtype: int64
</code></pre></div></div>

<ul>
  <li>
    <p>using explicit indexes while slicing <strong><em>include</em></strong> the final index</p>
  </li>
  <li>
    <p>using implicit index in slicing <strong><em>exclude</em></strong> the final index</p>
  </li>
</ul>

<p>What about i defined at creation time a Series with <strong>integer index values</strong> and i want to slice them ? 🙄</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">51</span><span class="p">})</span>
<span class="n">serie2</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1     4
2     8
3    51
dtype: int64
</code></pre></div></div>

<p>Here you see that for <strong>indexing</strong>, the explicit index is used, i.e. “element of index defined as <strong>3</strong>”, but for slicing it is takes elements from the 2nd indexed element to the 3rd, excluded, indexed element, no matter what value of index the elements are.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># indexing: defaults to select explicit index /  with label 3
</span><span class="n">serie2</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># slicing: defaults to select implicit indexes
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>51






3    51
dtype: int64
</code></pre></div></div>

<h4 id="loc-and-iloc-accessors">Loc and Iloc accessors</h4>

<p>These accessors give a great alternative from default, albeit confusing, slicing behaviors with respect to the indexes’values.</p>

<h5 id="using-loc-property">Using <code class="language-plaintext highlighter-rouge">loc</code> property:</h5>

<p>This forces indexing and slicing using the explicitly defined index values:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie2</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># indexing: on explicit index
</span><span class="n">serie2</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># slicing: on explicit index
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4






2     8
3    51
dtype: int64
</code></pre></div></div>

<h5 id="using-iloc-property">Using <code class="language-plaintext highlighter-rouge">iloc</code> property:</h5>

<p>This forces indexing and slicing using <em>implicit</em> indexes i.e. order of appearance of the elements from <code class="language-plaintext highlighter-rouge">0</code> (1st element) to <code class="language-plaintext highlighter-rouge">n-1</code> (last one). This also means you will never use something else in <code class="language-plaintext highlighter-rouge">iloc</code> accessors than integers.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie2</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># indexing: on implicit index
</span><span class="n">serie2</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># slicing: on implicit index
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>8






3    51
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie2</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="c1"># slicing: explicit index 
</span><span class="n">serie2</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="c1"># slicing: implicit index 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1     4
2     8
3    51
dtype: int64






2     8
3    51
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie2</span><span class="p">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span> <span class="c1"># fancy indexing
</span><span class="n">serie2</span><span class="p">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span> <span class="c1"># fancy indexing 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1    4
2    8
dtype: int64






2     8
3    51
dtype: int64
</code></pre></div></div>

<h3 id="dtypes">dtypes</h3>

<p>A serie being an-indexed array, it then maintain a well-known implementation feature from <code class="language-plaintext highlighter-rouge">numpy</code>that infers about the overall representation of the data within the array: the <code class="language-plaintext highlighter-rouge">dtype</code>.</p>

<p>Recall that infering the data representation which accomodates all elements in the array is what enables, in case, for example, of numerical data (integers, float), to not only stored the values as C integers (avoiding the overhead introduced by Python primitive types) but also to perform efficient operations on the C for-loop level, as it is not required to dynamically type-check every single elements of the array and find which function to dispatch accordingly.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">timeit</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">"int"</span><span class="p">).</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.14 ms ± 142 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">timeit</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">"float"</span><span class="p">).</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.25 ms ± 17.7 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="s">'The'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">'brown'</span><span class="p">,</span> <span class="s">'fox'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s</span><span class="o">*</span><span class="mi">2</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0        TheThe
1             6
2    brownbrown
3        foxfox
dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s</span><span class="p">.</span><span class="n">values</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array(['The', 3, 'brown', 'fox'], dtype=object)
</code></pre></div></div>

<blockquote>
  <p><a href="https://stackoverflow.com/questions/29877508/what-does-dtype-object-mean-while-creating-a-numpy-array">Link</a>. Creating an array with dtype=object is different. The memory taken by the array now is filled with pointers to Python objects which are being stored elsewhere in memory (much like a Python list is really just a list of pointers to objects, not the objects themselves).</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">timeit</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">"object"</span><span class="p">).</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>77.8 ms ± 4.15 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</code></pre></div></div>

<h2 id="index-object">Index object</h2>

<h3 id="can-be-sliced-or-indexed">can be sliced or indexed</h3>

<p>…just like an array, because it is indeed an one-dimensional array.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie2</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie2</span><span class="p">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Int64Index([1, 2], dtype='int64')
</code></pre></div></div>

<h3 id="have-sets-operations">have <code class="language-plaintext highlighter-rouge">set</code>s’ operations</h3>

<p>By this we mean it does have common bitwise operatoin</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie2</span><span class="p">.</span><span class="n">index</span> <span class="o">&amp;</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Int64Index([1], dtype='int64')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie2</span><span class="p">.</span><span class="n">index</span> <span class="o">^</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Int64Index([2, 3, 5], dtype='int64')
</code></pre></div></div>

<h3 id="are-immutables">are immutables</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie2</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">18</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Traceback (most recent call last):


  File "&lt;ipython-input-1096-707f9cda8675&gt;", line 1, in &lt;module&gt;
    serie2.index[0]=18


  File "/Users/lucbertin/.pyenv/versions/3.5.7/lib/python3.5/site-packages/pandas/core/indexes/base.py", line 4260, in __setitem__
    raise TypeError("Index does not support mutable operations")


TypeError: Index does not support mutable operations
</code></pre></div></div>

<h2 id="dataframe">DataFrame</h2>

<p>The “main thing” of this lecture that we are going to use intensively in the rest of this lecture:</p>

<ul>
  <li>
    <p>sequence of “aligned” Series objects (sharing the same indexes / like an Excel file).</p>
  </li>
  <li>
    <p>each Series object is a column.</p>
  </li>
  <li>
    <p>Hence <code class="language-plaintext highlighter-rouge">pd.DataFrame</code> can be seen as dictionnary of Series objects.</p>
  </li>
  <li>
    <p>Flexible rows and columns’ labels (<code class="language-plaintext highlighter-rouge">Index</code> objects for both).</p>
  </li>
</ul>

<h3 id="construction">Construction</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">({</span><span class="s">"Luc"</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s">"Corentin"</span><span class="p">:</span><span class="mi">29</span><span class="p">,</span> <span class="s">"René"</span><span class="p">:</span> <span class="mi">40</span><span class="p">})</span>
<span class="n">serie2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">({</span><span class="s">"René"</span><span class="p">:</span> <span class="s">"100%"</span><span class="p">,</span> <span class="s">"Corentin"</span><span class="p">:</span> <span class="s">"25%"</span><span class="p">,</span> <span class="s">"Luc"</span><span class="p">:</span> <span class="s">"20%"</span><span class="p">})</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># dictionnary of pd.Series
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">"note"</span><span class="p">:</span> <span class="n">serie1</span><span class="p">,</span> 
                   <span class="s">"charge_de_travail"</span><span class="p">:</span> <span class="n">serie2</span><span class="p">})</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>charge_de_travail</th>
      <th>note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Corentin</th>
      <td>25%</td>
      <td>29</td>
    </tr>
    <tr>
      <th>Luc</th>
      <td>20%</td>
      <td>25</td>
    </tr>
    <tr>
      <th>René</th>
      <td>100%</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># index objects on both columns and rows
</span><span class="n">df</span><span class="p">.</span><span class="n">index</span>
<span class="n">df</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['Corentin', 'Luc', 'René'], dtype='object')






Index(['charge_de_travail', 'note'], dtype='object')
</code></pre></div></div>

<blockquote>
  <p>If you pass an index and / or columns, you are guaranteeing the index and / or columns of the resulting DataFrame. Thus, a dict of Series plus a specific index will discard all data not matching up to the passed index.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">"note"</span><span class="p">:</span> <span class="n">serie1</span><span class="p">,</span> 
                    <span class="s">"charge_de_travail"</span><span class="p">:</span> <span class="n">serie2</span><span class="p">},</span> 
                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">"Corentin"</span><span class="p">,</span> <span class="s">"Luc"</span><span class="p">,</span> <span class="s">"Julie"</span><span class="p">],</span>
                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">"note"</span><span class="p">,</span> <span class="s">"autre"</span><span class="p">])</span>
<span class="n">df2</span> 
<span class="c1"># filled with NaN ("Not A Number") 
# when no value exist for the given (row_index, column_index)
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>note</th>
      <th>autre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Corentin</th>
      <td>29.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Luc</th>
      <td>25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Julie</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>The <code class="language-plaintext highlighter-rouge">DataFrame</code> can be constructed using a list of dictionary.</p>
<ul>
  <li>each <code class="language-plaintext highlighter-rouge">dict</code> element is a row.</li>
  <li>each key of each dict refers to a column.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s">'a'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'b'</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s">'b'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">'c'</span><span class="p">:</span> <span class="mi">4</span><span class="p">}])</span>
<span class="n">df2</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>3</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span>
             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"b"</span><span class="p">,</span> <span class="s">"c"</span><span class="p">],</span>
            <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">"Jean"</span><span class="p">,</span> <span class="s">"Jacques"</span><span class="p">,</span> <span class="s">"René"</span><span class="p">])</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jean</th>
      <td>1</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Jacques</th>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>René</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<p>You can also create a DataFrame by using pandas methods for reading supported file format, e.g. using <code class="language-plaintext highlighter-rouge">pd.read_csv</code> method.</p>

<h3 id="shape-property">Shape property</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(3, 2)
</code></pre></div></div>

<p>shape: tuple of the number of elements with respect to each dimension</p>

<ul>
  <li>
    <p>For a 1D array, the shape would be (n,) where n is the number of elements in your array.</p>
  </li>
  <li>
    <p>For a 2D array, the shape would be (n,m) where n is the number of rows and m is the number of columns in your array</p>
  </li>
</ul>

<p>accessing a column/<code class="language-plaintext highlighter-rouge">Serie</code> by key :</p>

<h3 id="accessing-columns">Accessing columns</h3>

<p>As <code class="language-plaintext highlighter-rouge">DataFrame</code> is seen like a dictionary of <code class="language-plaintext highlighter-rouge">Series</code> / columns, you can access one of them using the corresponding <strike>key</strike> column’index !</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'note'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Corentin    29
Luc         25
René        40
Name: note, dtype: int64
</code></pre></div></div>

<p>Using the attribute notation is <strong>not advised</strong> especially for assignements as some methods or attributes of the same name already exist in the DataFrame class’ own namespace.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">note</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Corentin    29
Luc         25
René        40
Name: note, dtype: int64
</code></pre></div></div>

<h3 id="indexing-or-slicing">Indexing or Slicing</h3>

<p>Indexing works the same way as for Series, but you have to account this time for the second dimension</p>

<p><code class="language-plaintext highlighter-rouge">df.loc_or_iloc[ dim1 = rows, dim2 = columns]</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># implicit indexing
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>charge_de_travail</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Corentin</th>
      <td>25%</td>
    </tr>
    <tr>
      <th>Luc</th>
      <td>20%</td>
    </tr>
    <tr>
      <th>René</th>
      <td>100%</td>
    </tr>
  </tbody>
</table>
</div>

<p><strong>columns slicing/indexing</strong> is optional here, without specifying it, you <strong>select only rows</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>charge_de_travail</th>
      <th>note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Corentin</th>
      <td>25%</td>
      <td>29</td>
    </tr>
    <tr>
      <th>Luc</th>
      <td>20%</td>
      <td>25</td>
    </tr>
    <tr>
      <th>René</th>
      <td>100%</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="s">"Corentin"</span><span class="p">:</span><span class="s">"Luc"</span><span class="p">,</span><span class="s">"charge_de_travail"</span><span class="p">:</span><span class="s">"note"</span><span class="p">]</span> <span class="c1"># explicit indexing
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>charge_de_travail</th>
      <th>note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Corentin</th>
      <td>25%</td>
      <td>29</td>
    </tr>
    <tr>
      <th>Luc</th>
      <td>20%</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div>

<p>same thing here, <strong>only rows selected</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:</span><span class="s">"Corentin"</span><span class="p">]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>charge_de_travail</th>
      <th>note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Corentin</th>
      <td>25%</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[[</span><span class="s">"Corentin"</span><span class="p">,</span> <span class="s">"Luc"</span><span class="p">],</span> <span class="p">:]</span> <span class="c1"># mixing slicing and fancy indexing
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>charge_de_travail</th>
      <th>note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Corentin</th>
      <td>25%</td>
      <td>29</td>
    </tr>
    <tr>
      <th>Luc</th>
      <td>20%</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div>

<p>Something to mention here: by default, without using accessors like <code class="language-plaintext highlighter-rouge">loc</code> and <code class="language-plaintext highlighter-rouge">iloc</code>, indexing or fancy indexing directly <code class="language-plaintext highlighter-rouge">df</code>, performs the indexing on its columns.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[[</span><span class="s">"charge_de_travail"</span><span class="p">]]</span> <span class="c1"># indexing directly df defaults to columns
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>charge_de_travail</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Corentin</th>
      <td>25%</td>
    </tr>
    <tr>
      <th>Luc</th>
      <td>20%</td>
    </tr>
    <tr>
      <th>René</th>
      <td>100%</td>
    </tr>
  </tbody>
</table>
</div>

<p>Finally, of course you can set a new value for an element on some (row_index, column_index) using either of those accessors:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
</code></pre></div></div>

<h3 id="masking-1">Masking</h3>

<p>You can also use masking here and draw comparisons on a <code class="language-plaintext highlighter-rouge">Dataframe</code> level (e.g. <code class="language-plaintext highlighter-rouge">df &gt; 3</code>), or on <code class="language-plaintext highlighter-rouge">Series</code>/column level, e.g. <code class="language-plaintext highlighter-rouge">df["sexe"] == "Homme"</code>, <code class="language-plaintext highlighter-rouge">df["age"] &gt; 18</code>.<br />
In the first case, the resulting object will be a <code class="language-plaintext highlighter-rouge">DataFrame</code> filled with boolean values. In the second one, as before, a <code class="language-plaintext highlighter-rouge">Series</code> with boolean values.</p>

<p>A difference here using Series as a mask is that filtering a <code class="language-plaintext highlighter-rouge">DataFrame</code> using only <code class="language-plaintext highlighter-rouge">true</code> evaluated values from a Series (a 1D indexed-array then), keeps the <strong>entire rows</strong> as you may have multiple aligned <code class="language-plaintext highlighter-rouge">Series</code>/ columns for one given Index (with a true value).</p>

<p>Slicing using slice notation (::), or masking is performed on rows by default.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mask</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"charge_de_travail"</span><span class="p">]</span><span class="o">==</span><span class="s">"25%"</span> 
<span class="n">mask</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Corentin     True
Luc         False
René        False
Name: charge_de_travail, dtype: bool
</code></pre></div></div>

<p>Note that the Series-like mask, having the explictly defined indexes from the original one, you can still use <code class="language-plaintext highlighter-rouge">df.loc</code> upon filtering.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="c1"># masking directly df is operated on rows
# same as df.loc[mask]
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>charge_de_travail</th>
      <th>note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Corentin</th>
      <td>25%</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># slicing directly df is operated on rows
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>charge_de_travail</th>
      <th>note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Corentin</th>
      <td>25%</td>
      <td>29</td>
    </tr>
    <tr>
      <th>Luc</th>
      <td>20%</td>
      <td>25</td>
    </tr>
    <tr>
      <th>René</th>
      <td>100%</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="operations-between-dataframes">Operations between <code class="language-plaintext highlighter-rouge">DataFrame</code>s</h3>

<p>What about multiplying all elements from a DataFrame by 2?<br />
What about adding 2 DataFrame ?</p>

<p>We first need to distinct 2 types of operations into binary and unary operations:</p>
<ul>
  <li>3 - 2 &lt;=&gt; substract(3,2) &lt;=&gt; <strong>binary operation</strong> (2 inputs)</li>
  <li>-2 &lt;=&gt; neg(2) &lt;=&gt; <strong>unary operation</strong> (one input)</li>
  <li>sin(2) &lt;=&gt; <strong>unary operation</strong> (one input)</li>
</ul>

<p>in <code class="language-plaintext highlighter-rouge">Pandas</code> :</p>
<ul>
  <li>unary operations on <code class="language-plaintext highlighter-rouge">df</code>s elements preserve the indexes.</li>
  <li>binary operations on elements from 2 <code class="language-plaintext highlighter-rouge">df</code>s <strong>align</strong> the operations on the indexes.
  These behaviors come from numpy <code class="language-plaintext highlighter-rouge">ufuncs</code> (universal functions i.e. vectorized functions i.e. that take the whole vector as input, applying the function element-wise) which can be used for <code class="language-plaintext highlighter-rouge">DataFrame</code>ss too.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> 
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># for reproducibility
</span><span class="n">data</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># creating an array of random integer values
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>3</td>
      <td>7</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>4</td>
      <td>3</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rng</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="n">df2</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>7</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<p>We will use for the later example of summation between 2 DataFrames, <code class="language-plaintext highlighter-rouge">reindex</code> just to rearranged indexes of <code class="language-plaintext highlighter-rouge">df2</code> (this does not change the association indexed-value !)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">.</span><span class="n">reindex</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1">#just to show rearranged indexes (does not change the association with the indexed data)
</span><span class="n">df2</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>7</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">+</span> <span class="n">df2</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>13.0</td>
      <td>5.0</td>
      <td>12.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.0</td>
      <td>16.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11.0</td>
      <td>4.0</td>
      <td>12.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>on line of index 0, <code class="language-plaintext highlighter-rouge">7+6 = 13</code>
 which shows indexes had been aligned during the binary operation</p>

<p>also notice the union of the indices during the binary operation. If one may not exist in either of the dataframes and the result can’t be evalutated, <code class="language-plaintext highlighter-rouge">NaN</code> fill the concerned entries</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="c1"># used in the binary operation 25+8 = 33)
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>13.0</td>
      <td>5.0</td>
      <td>12.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.0</td>
      <td>16.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11.0</td>
      <td>4.0</td>
      <td>12.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>33.0</td>
      <td>25.0</td>
      <td>34.0</td>
      <td>27.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="operations-between-series-and-dataframe">Operations between Series and Dataframe</h3>

<p>Performing an operation between a Serie and a DataFrame implies performing an operation between data structures of different shapes, hence implying numpy <strong>broadcasting</strong>.</p>

<p>From the Numpy docs:</p>

<blockquote>
  <p>Broadcasting is <strong>how numpy treats arrays with different shapes during arithmetic operations</strong>. 
Subject to certain constraints, the smaller array is “broadcast” across the larger array so that they <strong>have compatible shapes.</strong>
Broadcasting provides a means of vectorizing array operations so that looping occurs in C instead of Python</p>
</blockquote>

<p>The only requirement for broadcasting is a way aligning array dimensions such that either :</p>
<ul>
  <li>aligned dimensions are equal (so that operations are done on an element-by-element basis from 2 arrays of same shape)</li>
  <li>one of the aligned dimensions is 1 (in other words, dimensions with size 1 are stretched or “copied” to match the dimension of the other array)</li>
</ul>

<p>Operations between <code class="language-plaintext highlighter-rouge">pandas.Series</code> and <code class="language-plaintext highlighter-rouge">pandas.DataFram</code> then respect the numpy broadcasting rules:</p>
<blockquote>
  <p>If the two arrays <strong>differ in their number of dimensions</strong>, the shape of the one with <strong>fewer dimensions is padded with ones on its leading (left) side.’</strong>  (2)</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">shape</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:].</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>((3, 4), (4,), (1, 4))
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span>
<span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>3</td>
      <td>7</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>4</td>
      <td>3</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0    6
1    9
2    2
3    6
Name: 1, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">-</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#row-wise (1,4) copied other 3 times =&gt; (3,4)
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>-6</td>
      <td>5</td>
      <td>-2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>-5</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">-</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">sample</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># again: kept the index alignements during computation
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>-6</td>
      <td>5</td>
      <td>-2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>-5</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<p>if you want to do it columnwise and not row wise</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">__sub__</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># caution, the indexes operations will be based on the column indexes
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>-3.0</td>
      <td>1.0</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-3.0</td>
      <td>0.0</td>
      <td>-7.0</td>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"a"</span><span class="p">,</span><span class="s">"b"</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">"d"</span><span class="p">]</span>
<span class="n">df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>0</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>3</td>
      <td>7</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>4</td>
      <td>3</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a    6
b    9
0    2
d    6
Name: 1, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">__sub__</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
<span class="c1"># based on the column indexes
# only 0 match with one of the column index label
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>0</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>a</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>d</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="close-api-with-series-and-numpy">Close API with <code class="language-plaintext highlighter-rouge">Series</code> and <code class="language-plaintext highlighter-rouge">numpy</code></h3>

<p>The <code class="language-plaintext highlighter-rouge">DataFrame</code> object, constituted of <code class="language-plaintext highlighter-rouge">Series</code> object and being also an ‘enhanced version’ of a <code class="language-plaintext highlighter-rouge">numpy</code> array, no wonder why a major part of the API for one can be reused for the other.</p>

<p>Here are just example of reused methods or properties (you’ve seen other ones in the course like loc and iloc for instance):</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">shape</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>((3,), (3, 4))
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span> <span class="o">-</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">19</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">"a"</span><span class="p">,</span><span class="s">"b"</span><span class="p">])</span>
<span class="n">df2</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>5</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>2</td>
      <td>4</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>-2</td>
      <td>-15</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">dtypes</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">df2</span><span class="p">.</span><span class="n">dtypes</span><span class="p">)</span> 
<span class="c1"># NaN is a floating-point value, 
# hence the Series embedding it gets its dtype upcasted to float (if it were an int)
# this pd.Series supports fast operations contrarily to a Series of dtype=object
# because Python needs to type check dynamically every time
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a         int64
b         int64
0         int64
d         int64
notes    object
dtype: object
Name          object
id_account    object
id_client     object
dtype: object
</code></pre></div></div>

<h3 id="managing-missing-values">Managing missing values</h3>

<p>This is a real asset of pandas <code class="language-plaintext highlighter-rouge">Dataframe</code> in comparison to <code class="language-plaintext highlighter-rouge">numpy</code>(which would find other strategies for handling missing values during computations, using classes like “masked arrays”).<br />
Managing missing values, either by dropping or imputing them based on some type of criteria, is an crucial step you should always document during your data scientist experiments. It is always a hot spot in areas such as Statistics or Machine Learning.<br />
A mishandling of NA values can definitely have an impact on your results or greatly lower your model performance trained on the data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">]).</span><span class="n">isnull</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0    False
1     True
dtype: bool
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span>
<span class="n">df2</span><span class="p">.</span><span class="n">isnull</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">]).</span><span class="n">dropna</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0    2.0
dtype: float64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span>
<span class="n">df2</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># drop a column when contains one NA value
</span><span class="n">df2</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># drop a row when contains one NA value
</span><span class="n">df2</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">"all"</span><span class="p">)</span> <span class="c1"># drop a column when contains all NA value
</span><span class="n">df2</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># drop a column if below 3 non-NA value
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2</td>
      <td>-15.0</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span>
<span class="n">df2</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#fill NA with specified value
# fill NA backwards 
# i.e. using the following non-null element
# to fill preceding NA ones
# defaults on rows basis
</span><span class="n">df2</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">"bfill"</span><span class="p">)</span> 
<span class="n">df2</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">"bfill"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># on column basis
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>5</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>2</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>5</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2.0</td>
      <td>-2.0</td>
      <td>-15.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="multiindex">MultiIndex</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="p">{(</span><span class="s">'group1'</span><span class="p">,</span> <span class="s">'Luc'</span><span class="p">):</span> <span class="mi">18</span><span class="p">,</span>
        <span class="p">(</span><span class="s">'group2'</span><span class="p">,</span> <span class="s">'Jean'</span><span class="p">):</span> <span class="mi">23</span><span class="p">,</span>
        <span class="p">(</span><span class="s">'group1'</span><span class="p">,</span> <span class="s">'Seb'</span><span class="p">):</span> <span class="mi">17</span><span class="p">,</span>
        <span class="p">(</span><span class="s">'group1'</span><span class="p">,</span> <span class="s">'René'</span><span class="p">):</span> <span class="mi">4</span><span class="p">,</span>
        <span class="p">(</span><span class="s">'group2'</span><span class="p">,</span> <span class="s">'Alex'</span><span class="p">):</span> <span class="mi">4</span><span class="p">,</span>
        <span class="p">(</span><span class="s">'group3'</span><span class="p">,</span> <span class="s">'Sophie'</span><span class="p">):</span> <span class="mi">25</span><span class="p">,</span>
        <span class="p">(</span><span class="s">'group2'</span><span class="p">,</span> <span class="s">'Camille'</span><span class="p">):</span> <span class="mi">2</span> <span class="p">}</span>
<span class="n">serie</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">serie</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>group1  Luc        18
        René        4
        Seb        17
group2  Alex        4
        Camille     2
        Jean       23
group3  Sophie     25
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">[:,</span><span class="s">"Luc"</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>group1    18
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">[</span><span class="s">"group1"</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Luc     18
René     4
Seb     17
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">[</span><span class="n">serie</span><span class="o">&gt;=</span><span class="mi">18</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>group1  Luc       18
group2  Jean      23
group3  Sophie    25
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># creating the multi-index using cartesian product
</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">MultiIndex</span><span class="p">.</span><span class="n">from_arrays</span><span class="p">([[</span><span class="s">'group1'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">],</span> <span class="p">[</span><span class="s">"Luc"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="c1"># works for multi-index too !
# Conform Series to new index with optional filling logic, placing
# NA/NaN in locations having no value in the previous index
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>group1  Luc    18.0
a       2       NaN
b       1       NaN
        2       NaN
dtype: float64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># hierarchical indices and columns
</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">MultiIndex</span><span class="p">.</span><span class="n">from_product</span><span class="p">([[</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
                                   <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">'year'</span><span class="p">,</span> <span class="s">'visit'</span><span class="p">])</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">MultiIndex</span><span class="p">.</span><span class="n">from_product</span><span class="p">(</span>
    <span class="p">[[</span><span class="s">'Bob'</span><span class="p">,</span> <span class="s">'Guido'</span><span class="p">,</span> <span class="s">'Sue'</span><span class="p">],</span> <span class="p">[</span><span class="s">'HR'</span><span class="p">,</span> <span class="s">'Temp'</span><span class="p">]],</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">'subject'</span><span class="p">,</span> <span class="s">'type'</span><span class="p">])</span>
<span class="c1"># mock some data
</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="p">[:,</span> <span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">10</span>
<span class="n">data</span> <span class="o">+=</span> <span class="mi">37</span>
<span class="c1"># create the DataFrame
</span><span class="n">health_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span> 
<span class="n">health_data</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr>
      <th></th>
      <th>subject</th>
      <th colspan="2" halign="left">Bob</th>
      <th colspan="2" halign="left">Guido</th>
      <th colspan="2" halign="left">Sue</th>
    </tr>
    <tr>
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <td>52.0</td>
      <td>36.4</td>
      <td>38.0</td>
      <td>36.6</td>
      <td>32.0</td>
      <td>38.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>28.0</td>
      <td>37.7</td>
      <td>47.0</td>
      <td>35.4</td>
      <td>50.0</td>
      <td>36.4</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2014</th>
      <th>1</th>
      <td>30.0</td>
      <td>37.0</td>
      <td>16.0</td>
      <td>36.6</td>
      <td>49.0</td>
      <td>37.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>52.0</td>
      <td>36.8</td>
      <td>31.0</td>
      <td>35.5</td>
      <td>36.0</td>
      <td>37.6</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">health_data</span><span class="p">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">2013</span> <span class="p">,</span> <span class="p">(</span><span class="s">"Bob"</span><span class="p">)]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <td>52.0</td>
      <td>36.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>28.0</td>
      <td>37.7</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#health_data.loc[(:,1),["Bob"]] # can't use the tuple to define index
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">IndexSlice</span>
<span class="n">health_data</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">idx</span><span class="p">[:,</span> <span class="s">'HR'</span><span class="p">]]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr>
      <th></th>
      <th>subject</th>
      <th>Bob</th>
      <th>Guido</th>
      <th>Sue</th>
    </tr>
    <tr>
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>HR</th>
      <th>HR</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013</th>
      <th>1</th>
      <td>52.0</td>
      <td>38.0</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>2014</th>
      <th>1</th>
      <td>30.0</td>
      <td>16.0</td>
      <td>49.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="unstacking-and-stacking-a-matter-of-dimensionality">Unstacking and Stacking: a matter of dimensionality</h3>

<p>Creating a multiIndex rather than a simple Index is like <strong>creating an extra-dimension in our dataset.</strong></p>

<p>We can take for <strong>each year</strong>, a <strong>2D sub-dataframe</strong> composed of <strong>Bob’s HR visits</strong>.</p>

<p>This DataFrame hence can be seen as having <strong>4 dimensions.</strong></p>

<p>we can go back and forth from a multi-index series to a dataframe using unstack, so that one of the index level occupies the extra dimension given by the transition to a <code class="language-plaintext highlighter-rouge">DataFrame</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>group1  Luc        18
        René        4
        Seb        17
group2  Alex        4
        Camille     2
        Jean       23
group3  Sophie     25
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie</span><span class="p">.</span><span class="n">unstack</span><span class="p">()</span> <span class="c1">#level -1 by default = most inner one
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Alex</th>
      <th>Camille</th>
      <th>Jean</th>
      <th>Luc</th>
      <th>René</th>
      <th>Seb</th>
      <th>Sophie</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>group1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.0</td>
      <td>4.0</td>
      <td>17.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>group2</th>
      <td>4.0</td>
      <td>2.0</td>
      <td>23.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>group3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>25.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df3</span> <span class="o">=</span> <span class="n">serie</span><span class="p">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df3</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group1</th>
      <th>group2</th>
      <th>group3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Alex</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Camille</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Jean</th>
      <td>NaN</td>
      <td>23.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Luc</th>
      <td>18.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>René</th>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Seb</th>
      <td>17.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Sophie</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>25.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># to reset the index and create it as a simple new column you can use reset_index()
</span><span class="n">df3</span><span class="p">.</span><span class="n">reset_index</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>group1</th>
      <th>group2</th>
      <th>group3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alex</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Camille</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jean</td>
      <td>NaN</td>
      <td>23.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Luc</td>
      <td>18.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>René</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Seb</td>
      <td>17.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Sophie</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>25.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>You can do some aggregation by index level (we are going to see this extensively on <code class="language-plaintext highlighter-rouge">GroupBy</code> section</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">health_data</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s">'year'</span><span class="p">)</span>
<span class="n">health_data</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s">'visit'</span><span class="p">)</span>
<span class="n">health_data</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'type'</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr>
      <th>subject</th>
      <th colspan="2" halign="left">Bob</th>
      <th colspan="2" halign="left">Guido</th>
      <th colspan="2" halign="left">Sue</th>
    </tr>
    <tr>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013</th>
      <td>40.0</td>
      <td>37.05</td>
      <td>42.5</td>
      <td>36.00</td>
      <td>41.0</td>
      <td>37.25</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>41.0</td>
      <td>36.90</td>
      <td>23.5</td>
      <td>36.05</td>
      <td>42.5</td>
      <td>37.65</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr>
      <th>subject</th>
      <th colspan="2" halign="left">Bob</th>
      <th colspan="2" halign="left">Guido</th>
      <th colspan="2" halign="left">Sue</th>
    </tr>
    <tr>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>visit</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>41.0</td>
      <td>36.70</td>
      <td>27.0</td>
      <td>36.60</td>
      <td>40.5</td>
      <td>37.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>40.0</td>
      <td>37.25</td>
      <td>39.0</td>
      <td>35.45</td>
      <td>43.0</td>
      <td>37.0</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <td>40.666667</td>
      <td>37.033333</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41.666667</td>
      <td>36.500000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2014</th>
      <th>1</th>
      <td>31.666667</td>
      <td>37.100000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>39.666667</td>
      <td>36.633333</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="concatenating-dataframes">Concatenating <code class="language-plaintext highlighter-rouge">DataFrame</code>s</h3>

<p><code class="language-plaintext highlighter-rouge">pd.concat</code> is here for the rescue !</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df1</span>
<span class="n">df2</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>False</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>False</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>False</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># concatenate rows (default)
</span><span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># concatenate columns (default)
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>0</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>False</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>False</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>False</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>the indices are preserved, even duplicated</p>

<p><code class="language-plaintext highlighter-rouge">verify_integrity=True</code> can check if index from each df are differents</p>

<p><code class="language-plaintext highlighter-rouge">ignore_index=True</code> just override the indexes after concatenation by a new integer one</p>

<p><code class="language-plaintext highlighter-rouge">keys = ["source1", "source2"]</code> leave the indexes as is but create a new outer level from the 2 different sources/df of the data concatenated</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s">"source1"</span><span class="p">,</span> <span class="s">"source2"</span><span class="p">])</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">source1</th>
      <th>0</th>
      <td>2.0</td>
      <td>0</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">source2</th>
      <th>0</th>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p><code class="language-plaintext highlighter-rouge">join='inner'</code> keeps only the columns in common from the concatenation</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span><span class="p">[</span><span class="s">"note"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">df2</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
      <th>note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s">'inner'</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>0</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie1</span>
<span class="n">serie2</span>
<span class="n">serie1</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">serie2</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Corentin    29
Luc         25
René        40
dtype: int64






Corentin     25%
Luc          20%
René        100%
dtype: object






Corentin      29
Luc           25
René          40
Corentin     25%
Luc          20%
René        100%
dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df1</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Users/lucbertin/.pyenv/versions/3.5.7/lib/python3.5/site-packages/pandas/core/frame.py:7138: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass 'sort=False'.

To retain the current behavior and silence the warning, pass 'sort=True'.

  sort=sort,
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>a</th>
      <th>b</th>
      <th>d</th>
      <th>note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>-2</td>
      <td>-15.0</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="merging-dataframes">Merging <code class="language-plaintext highlighter-rouge">DataFrame</code>s</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_account</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'accountNumber'</span><span class="p">:</span> <span class="p">[</span><span class="s">"AC1"</span><span class="p">,</span> <span class="s">"AC2"</span><span class="p">,</span> <span class="s">"AC3"</span><span class="p">,</span> <span class="s">"AC4"</span><span class="p">],</span>
                   <span class="s">'Amount'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">109300</span><span class="p">,</span> <span class="mi">2984</span><span class="p">,</span> <span class="mi">1999</span><span class="p">],</span>
                   <span class="s">'Name'</span><span class="p">:</span> <span class="p">[</span><span class="s">"LIVRET A"</span><span class="p">,</span> <span class="s">"Compte Épargne Retraite"</span><span class="p">,</span> <span class="s">"Quadretto"</span><span class="p">,</span> <span class="s">"Compte Courant"</span><span class="p">]})</span>
<span class="n">df_client</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'id_account'</span><span class="p">:</span> <span class="p">[</span><span class="s">"AC1"</span><span class="p">,</span> <span class="s">"AC2"</span><span class="p">,</span> <span class="s">"AC3"</span><span class="p">,</span> <span class="s">"AC4"</span><span class="p">,</span> <span class="s">"AC5"</span><span class="p">],</span>
                   <span class="s">'Name'</span><span class="p">:</span> <span class="p">[</span><span class="s">"Luc"</span><span class="p">,</span> <span class="s">"René"</span><span class="p">,</span> <span class="s">"Jean"</span><span class="p">,</span> <span class="s">"Jean"</span><span class="p">,</span> <span class="s">"Joseph"</span><span class="p">],</span>
                   <span class="s">'id_client'</span><span class="p">:</span> <span class="p">[</span><span class="s">"ID1099"</span><span class="p">,</span> <span class="s">"ID1091"</span><span class="p">,</span> <span class="s">"ID1018"</span><span class="p">,</span> <span class="s">"ID1018"</span><span class="p">,</span> <span class="s">"ID1021"</span><span class="p">]})</span>
<span class="n">df_account</span>
<span class="n">df_client</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Amount</th>
      <th>Name</th>
      <th>accountNumber</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10000</td>
      <td>LIVRET A</td>
      <td>AC1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>109300</td>
      <td>Compte Épargne Retraite</td>
      <td>AC2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2984</td>
      <td>Quadretto</td>
      <td>AC3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1999</td>
      <td>Compte Courant</td>
      <td>AC4</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>id_account</th>
      <th>id_client</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Luc</td>
      <td>AC1</td>
      <td>ID1099</td>
    </tr>
    <tr>
      <th>1</th>
      <td>René</td>
      <td>AC2</td>
      <td>ID1091</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jean</td>
      <td>AC3</td>
      <td>ID1018</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jean</td>
      <td>AC4</td>
      <td>ID1018</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joseph</td>
      <td>AC5</td>
      <td>ID1021</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df_account</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">df_client</span><span class="p">,</span> 
         <span class="n">left_on</span><span class="o">=</span><span class="s">"accountNumber"</span><span class="p">,</span> 
         <span class="n">right_on</span><span class="o">=</span><span class="s">"id_account"</span><span class="p">,</span>
         <span class="n">how</span><span class="o">=</span><span class="s">'inner'</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Amount</th>
      <th>Name_x</th>
      <th>accountNumber</th>
      <th>Name_y</th>
      <th>id_account</th>
      <th>id_client</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10000</td>
      <td>LIVRET A</td>
      <td>AC1</td>
      <td>Luc</td>
      <td>AC1</td>
      <td>ID1099</td>
    </tr>
    <tr>
      <th>1</th>
      <td>109300</td>
      <td>Compte Épargne Retraite</td>
      <td>AC2</td>
      <td>René</td>
      <td>AC2</td>
      <td>ID1091</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2984</td>
      <td>Quadretto</td>
      <td>AC3</td>
      <td>Jean</td>
      <td>AC3</td>
      <td>ID1018</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1999</td>
      <td>Compte Courant</td>
      <td>AC4</td>
      <td>Jean</td>
      <td>AC4</td>
      <td>ID1018</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df_account</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">df_client</span><span class="p">,</span> 
         <span class="n">left_on</span><span class="o">=</span><span class="s">"accountNumber"</span><span class="p">,</span> 
         <span class="n">right_on</span><span class="o">=</span><span class="s">"id_account"</span><span class="p">,</span>
         <span class="n">how</span><span class="o">=</span><span class="s">'right'</span><span class="p">,</span>
         <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s">"_account"</span><span class="p">,</span> <span class="s">"_client"</span><span class="p">])</span>
<span class="n">df_merged</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Amount</th>
      <th>Name_account</th>
      <th>accountNumber</th>
      <th>Name_client</th>
      <th>id_account</th>
      <th>id_client</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10000.0</td>
      <td>LIVRET A</td>
      <td>AC1</td>
      <td>Luc</td>
      <td>AC1</td>
      <td>ID1099</td>
    </tr>
    <tr>
      <th>1</th>
      <td>109300.0</td>
      <td>Compte Épargne Retraite</td>
      <td>AC2</td>
      <td>René</td>
      <td>AC2</td>
      <td>ID1091</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2984.0</td>
      <td>Quadretto</td>
      <td>AC3</td>
      <td>Jean</td>
      <td>AC3</td>
      <td>ID1018</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1999.0</td>
      <td>Compte Courant</td>
      <td>AC4</td>
      <td>Jean</td>
      <td>AC4</td>
      <td>ID1018</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Joseph</td>
      <td>AC5</td>
      <td>ID1021</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># to drop the (same) column we have been merging on
</span><span class="n">df_merged</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'id_account'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Amount</th>
      <th>Name_account</th>
      <th>accountNumber</th>
      <th>Name_client</th>
      <th>id_client</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10000.0</td>
      <td>LIVRET A</td>
      <td>AC1</td>
      <td>Luc</td>
      <td>ID1099</td>
    </tr>
    <tr>
      <th>1</th>
      <td>109300.0</td>
      <td>Compte Épargne Retraite</td>
      <td>AC2</td>
      <td>René</td>
      <td>ID1091</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2984.0</td>
      <td>Quadretto</td>
      <td>AC3</td>
      <td>Jean</td>
      <td>ID1018</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1999.0</td>
      <td>Compte Courant</td>
      <td>AC4</td>
      <td>Jean</td>
      <td>ID1018</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Joseph</td>
      <td>ID1021</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#df_notes["eleve"] = (df_notes
# .eleve
# .astype("category")
# .cat.rename_categories(
#     new_categories=
#        ["eleve{}".format(i) for i in range(df_notes.eleve.nunique())]
# )
#)
</span></code></pre></div></div>

<h3 id="apply">Apply</h3>

<p>For the following sections, we are going to use real world data of students’grades from an exam I gave 😜 The data has been anonymised to fit GDPR regulation.</p>

<p>It has been retrieved by scrapping automatically the online web app that stores the results from each passed quizz.</p>

<p>You will see along the way we will need to make multiple modifications to our original data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># !curl --help 
# option :  -o, --output &lt;file&gt; 
# Write to file instead of stdout
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">curl</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">Luc</span><span class="o">-</span><span class="n">Bertin</span><span class="o">/</span><span class="n">TDs_ESILV</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">td3_discover_pandas</span><span class="o">/</span><span class="n">notes_eleves</span><span class="p">.</span><span class="n">csv</span> <span class="o">-</span><span class="n">o</span> <span class="s">"notes.csv"</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 21979  100 21979    0     0  66805      0 --:--:-- --:--:-- --:--:-- 66805
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"notes.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># showing just the first n rows
</span><span class="n">df_notes</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># or the last n rows
</span><span class="n">df_notes</span><span class="p">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eleve</th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>eleve0</td>
      <td>71,43 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>eleve1</td>
      <td>100 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eleve4</td>
      <td>71,43 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>eleve6</td>
      <td>42,86 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>eleve8</td>
      <td>57,14 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
  </tbody>
</table>
</div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eleve</th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>741</th>
      <td>eleve174</td>
      <td>100 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>742</th>
      <td>eleve166</td>
      <td>66,67 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>743</th>
      <td>eleve176</td>
      <td>83,33 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>744</th>
      <td>eleve186</td>
      <td>100 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>745</th>
      <td>eleve196</td>
      <td>66,67 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="on-a-series-object">On a Series object</h4>

<p>Let’s define a function to be applied for each element of a column.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="s">"""A fonction to be applied on each element of a pandas DataFrame column / Series """</span>
    <span class="c1"># we need to return a value for each element computation
</span>    <span class="k">return</span> <span class="n">val</span><span class="p">.</span><span class="n">upper</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">eleve</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">function</span><span class="p">)</span> <span class="c1"># the function applies on each value in the column
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0        ELEVE0
1        ELEVE1
2        ELEVE4
3        ELEVE6
4        ELEVE8
         ...   
741    ELEVE174
742    ELEVE166
743    ELEVE176
744    ELEVE186
745    ELEVE196
Name: eleve, Length: 746, dtype: object
</code></pre></div></div>

<p>behind, apply is looping on each element of the column <code class="language-plaintext highlighter-rouge">eleve</code> and returning a value for each of them</p>

<h4 id="on-a-dataframe-object">on a <code class="language-plaintext highlighter-rouge">DataFrame</code> object</h4>

<p>We can also use the <code class="language-plaintext highlighter-rouge">apply</code> method on a <code class="language-plaintext highlighter-rouge">DataFrame</code> object, but we need to provide an axis.<br />
applied function won’t be fed a single column element this time but a Series.<br />
a Series whose index depends on the axis we choose !</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eleve</th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>eleve0</td>
      <td>71,43 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>eleve1</td>
      <td>100 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eleve4</td>
      <td>71,43 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>eleve6</td>
      <td>42,86 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>eleve8</td>
      <td>57,14 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>741</th>
      <td>eleve174</td>
      <td>100 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>742</th>
      <td>eleve166</td>
      <td>66,67 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>743</th>
      <td>eleve176</td>
      <td>83,33 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>744</th>
      <td>eleve186</td>
      <td>100 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>745</th>
      <td>eleve196</td>
      <td>66,67 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
  </tbody>
</table>
<p>746 rows × 4 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="s">"""A fonction to be applied on each row of the DataFrame
    i.e. each row is indeed a pandas.Series object 
    passed-in the applied function at each loop iteration.
    We will need later on to use axis=1 for Series to be the rows"""</span>
    
    <span class="c1"># having a full row we can do many things to create
</span>    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span> <span class="n">row</span><span class="p">[</span><span class="s">"eleve"</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"pair"</span>
    <span class="k">return</span> <span class="s">"impair"</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0        pair
1      impair
2        pair
3        pair
4        pair
        ...  
741      pair
742      pair
743      pair
744      pair
745      pair
Length: 746, dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="s">"""Another function on rows but returning a pandas.Series each time
    i.e. then the final result will be a stack of pandas.Series along an axis or the other
    i.e. &lt;=&gt; a DataFrame"""</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span> <span class="n">row</span><span class="p">[</span><span class="s">"eleve"</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">odd_or_even</span> <span class="o">=</span> <span class="s">"pair"</span>
    <span class="n">odd_or_even</span> <span class="o">=</span> <span class="s">"impair"</span>
    
    <span class="n">cut_note</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">"note"</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># what precedes the comma
</span>    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span> <span class="n">odd_or_even</span><span class="p">,</span> <span class="n">cut_note</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'odd_or_even'</span><span class="p">,</span> <span class="s">'cut_note'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># a pandas.Series for each row
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>odd_or_even</th>
      <th>cut_note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>impair</td>
      <td>71</td>
    </tr>
    <tr>
      <th>1</th>
      <td>impair</td>
      <td>100 %</td>
    </tr>
    <tr>
      <th>2</th>
      <td>impair</td>
      <td>71</td>
    </tr>
    <tr>
      <th>3</th>
      <td>impair</td>
      <td>42</td>
    </tr>
    <tr>
      <th>4</th>
      <td>impair</td>
      <td>57</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>741</th>
      <td>impair</td>
      <td>100 %</td>
    </tr>
    <tr>
      <th>742</th>
      <td>impair</td>
      <td>66</td>
    </tr>
    <tr>
      <th>743</th>
      <td>impair</td>
      <td>83</td>
    </tr>
    <tr>
      <th>744</th>
      <td>impair</td>
      <td>100 %</td>
    </tr>
    <tr>
      <th>745</th>
      <td>impair</td>
      <td>66</td>
    </tr>
  </tbody>
</table>
<p>746 rows × 2 columns</p>
</div>

<p>To avoid having to define a loop we should use vectorized functions (we will talk about it later on).
On integers (not the case here) use of vectorized functions can greatly improve computational speed. (C-loop)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
    <span class="s">"""Another function on cols this time"""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">col</span><span class="p">])</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"can't sum on this col"</span>
    <span class="c1">#return pd.Series([ odd_or_even, cut_note], index=['odd_or_even', 'cut_note'])
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># a pandas.Series for each col
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>eleve     can't sum on this col
note                       3053
groupe    can't sum on this col
quizz     can't sum on this col
dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">note</span><span class="p">.</span><span class="nb">str</span><span class="p">[:</span><span class="mi">1</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">).</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3053.0
</code></pre></div></div>

<h3 id="manipulating-columns-with-strings">Manipulating columns with strings</h3>

<p>Back to the definition of a vectorized function: it is a function that applies on the whole sequence rather than each element as input.</p>

<p>This is the case for numpy functions like <code class="language-plaintext highlighter-rouge">np.mean</code>, <code class="language-plaintext highlighter-rouge">np.sum</code>, <code class="language-plaintext highlighter-rouge">np.std</code> which apply on a numerically valued input array as a whole, so the loop is moved from the Python-level to the <a href="https://stackoverflow.com/questions/58071631/is-numpy-vectorization-using-c-loops">C one</a></p>

<blockquote>
  <p>Numeric types include: <code class="language-plaintext highlighter-rouge">int</code>, <code class="language-plaintext highlighter-rouge">float</code>, <code class="language-plaintext highlighter-rouge">datetime</code>, <code class="language-plaintext highlighter-rouge">bool</code>, <code class="language-plaintext highlighter-rouge">category</code>. They exclude <code class="language-plaintext highlighter-rouge">object</code> dtype and can be held in <strong>contiguous memory blocks</strong>. See <a href="https://stackoverflow.com/questions/26998223/what-is-the-difference-between-contiguous-and-non-contiguous-arrays">here too, concerning C contiguous array stored in memory when creating a numpy array</a>.</p>
</blockquote>

<blockquote>
  <p>Why are numpy operations more efficient than simple crude Python ?  as we’ve seen earlier <strong>Everything in Python is an object</strong>. This includes, unlike C, numbers. Python types therefore have an <strong>overhead which does not exist with native C types</strong>. NumPy methods are <strong>usually C-based.</strong></p>
</blockquote>

<p>check <a href="https://stackoverflow.com/questions/52673285/performance-of-pandas-apply-vs-np-vectorize-to-create-new-column-from-existing-c">here</a></p>

<blockquote>
  <p>np.vectorize is fake vectorisation. According to <a href="https://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.vectorize.html">documentation</a>: The vectorize function is provided primarily for convenience, not for performance. The implementation is essentially a for loop. It means there is no reazon in vectorize of function wich could be applied directly as it is in your example. Actually this could lead to degraded performance. Main goal of the “vectorize” is to hide a for loop from you code. But it will not avoid it neither change expected results.</p>
</blockquote>

<p>This link provides a good an example of simple <a href="https://engineering.upside.com/a-beginners-guide-to-optimizing-pandas-code-for-speed-c09ef2c6a4d6">vectorization</a>.</p>

<p>Numpy does not provide vectorization functions for arrays of strings.</p>

<p>Pandas provide vectorized <a href="https://stackoverflow.com/questions/50744369/how-to-speed-up-pandas-string-function">str operations</a>. Pros are that you don’t have to write any loop and can take the column/Series as a whole. Cons are that they are not actually faster than using a simply apply. String operations are inherently difficult to vectorize. Pandas treats strings as objects, and all operations on objects fall back to a slow, loopy implementation.</p>

<p>Already provided Pandas vectorized string methods available in <code class="language-plaintext highlighter-rouge">.str.</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">[</span><span class="s">"eleve"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_notes</span><span class="p">.</span><span class="n">eleve</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">capitalize</span><span class="p">()</span>
<span class="n">df_notes</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eleve</th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Eleve0</td>
      <td>71,43 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Eleve1</td>
      <td>100 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Eleve4</td>
      <td>71,43 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Eleve6</td>
      <td>42,86 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eleve8</td>
      <td>57,14 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>741</th>
      <td>Eleve174</td>
      <td>100 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>742</th>
      <td>Eleve166</td>
      <td>66,67 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>743</th>
      <td>Eleve176</td>
      <td>83,33 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>744</th>
      <td>Eleve186</td>
      <td>100 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>745</th>
      <td>Eleve196</td>
      <td>66,67 %</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
  </tbody>
</table>
<p>746 rows × 4 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mask</span> <span class="o">=</span> <span class="n">df_notes</span><span class="p">.</span><span class="n">groupe</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"U"</span><span class="p">)</span>
<span class="n">mask</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0       True
1       True
2       True
3       True
4       True
       ...  
741    False
742    False
743    False
744    False
745    False
Name: groupe, Length: 746, dtype: bool
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eleve</th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Eleve0</td>
      <td>71,43 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Eleve1</td>
      <td>100 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Eleve4</td>
      <td>71,43 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Eleve6</td>
      <td>42,86 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eleve8</td>
      <td>57,14 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Eleve202</td>
      <td>57,14 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Eleve203</td>
      <td>57,14 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Eleve204</td>
      <td>71,43 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Eleve205</td>
      <td>42,86 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Eleve207</td>
      <td>42,86 %</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
  </tbody>
</table>
<p>92 rows × 4 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">note</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0      [71, 43 %]
1         [100 %]
2      [71, 43 %]
3      [42, 86 %]
4      [57, 14 %]
          ...    
741       [100 %]
742    [66, 67 %]
743    [83, 33 %]
744       [100 %]
745    [66, 67 %]
Name: note, Length: 746, dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">df_notes</span><span class="p">.</span><span class="n">note</span>
 <span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"%"</span><span class="p">,</span><span class="s">""</span><span class="p">)</span> <span class="c1"># replace all occurences of "%" as ""
</span> <span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">","</span><span class="p">,</span> <span class="s">"."</span><span class="p">)</span> <span class="c1"># replace all occurences of "," as "."
</span> <span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0       71.43
1      100.00
2       71.43
3       42.86
4       57.14
        ...  
741    100.00
742     66.67
743     83.33
744    100.00
745     66.67
Name: note, Length: 746, dtype: float64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">df_notes</span><span class="p">.</span><span class="n">note</span>
 <span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="s">"(\d+),?(\d+)?"</span><span class="p">)</span> <span class="c1">#regex to find all matching groups in each element of the Series
</span> <span class="p">.</span><span class="nb">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># vectorized element access in the column, works for all iterable, hence even a list in a pd.Series, 
</span> <span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">"."</span><span class="p">)</span> <span class="c1"># join the lists with "." rather than ','
</span> <span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span> <span class="c1"># take off the last dot if exists
</span> <span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># convert to float type
</span><span class="p">)</span> 
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0       71.43
1      100.00
2       71.43
3       42.86
4       57.14
        ...  
741    100.00
742     66.67
743     83.33
744    100.00
745     66.67
Name: note, Length: 746, dtype: float64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serie_notes</span> <span class="o">=</span>\
<span class="p">(</span> 
<span class="n">df_notes</span><span class="p">.</span><span class="n">note</span>
 <span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">extract</span><span class="p">(</span><span class="s">"(\d+),?(\d+)?"</span><span class="p">)</span> <span class="c1"># expand to multiple cols
</span> <span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># fill NaN as 0 when no matched group
</span> <span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># convert to float
</span><span class="p">)</span>
<span class="n">serie_notes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">serie_notes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span>
<span class="n">serie_notes</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">note</span> <span class="o">=</span> <span class="n">serie_notes</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eleve</th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Eleve0</td>
      <td>71.43</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Eleve1</td>
      <td>100.00</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Eleve4</td>
      <td>71.43</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Eleve6</td>
      <td>42.86</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eleve8</td>
      <td>57.14</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>741</th>
      <td>Eleve174</td>
      <td>100.00</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>742</th>
      <td>Eleve166</td>
      <td>66.67</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>743</th>
      <td>Eleve176</td>
      <td>83.33</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>744</th>
      <td>Eleve186</td>
      <td>100.00</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>745</th>
      <td>Eleve196</td>
      <td>66.67</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
  </tbody>
</table>
<p>746 rows × 4 columns</p>
</div>

<h3 id="other-interesting-functions-to-mention">Other interesting functions to mention</h3>

<p>To compute the counts of unique values use : <code class="language-plaintext highlighter-rouge">pd.Series.value_counts()</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">groupe</span><span class="p">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ibo1       117
ibo5       115
ibo7       114
Unknown     92
ibo6        85
ibo3        85
ibo4        81
ibo2        57
Name: groupe, dtype: int64
</code></pre></div></div>

<p>To do a <code class="language-plaintext highlighter-rouge">binning</code> : i.e. group a number of more or less continuous values into a smaller number of “bins”. Use `pd.cut</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df_notes</span><span class="p">.</span><span class="n">note</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># 5 equal sized bins
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0       (60.0, 80.0]
1      (80.0, 100.0]
2       (60.0, 80.0]
3       (40.0, 60.0]
4       (40.0, 60.0]
           ...      
741    (80.0, 100.0]
742     (60.0, 80.0]
743    (80.0, 100.0]
744    (80.0, 100.0]
745     (60.0, 80.0]
Name: note, Length: 746, dtype: category
Categories (5, interval[float64]): [(-0.1, 20.0] &lt; (20.0, 40.0] &lt; (40.0, 60.0] &lt; (60.0, 80.0] &lt; (80.0, 100.0]]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df_notes</span><span class="p">.</span><span class="n">note</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0       (50, 75]
1      (75, 100]
2       (50, 75]
3        (0, 50]
4       (50, 75]
         ...    
741    (75, 100]
742     (50, 75]
743    (75, 100]
744    (75, 100]
745     (50, 75]
Name: note, Length: 746, dtype: category
Categories (3, interval[int64]): [(0, 50] &lt; (50, 75] &lt; (75, 100]]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span><span class="p">:</span> 
    <span class="n">pd</span><span class="p">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df_notes</span><span class="p">.</span><span class="n">note</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">"Bad"</span><span class="p">])</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Bin labels must be one fewer than the number of bin edges
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">[</span><span class="s">'appreciation'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df_notes</span><span class="p">.</span><span class="n">note</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">"Very Bad"</span><span class="p">,</span> <span class="s">"Bad"</span><span class="p">,</span> <span class="s">"Ok"</span><span class="p">,</span> <span class="s">"Good"</span><span class="p">])</span>
<span class="n">df_notes</span><span class="p">.</span><span class="n">appreciation</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0        Ok
1      Good
2        Ok
3       Bad
4        Ok
       ... 
741    Good
742      Ok
743    Good
744    Good
745      Ok
Name: note, Length: 746, dtype: category
Categories (4, object): [Very Bad &lt; Bad &lt; Ok &lt; Good]
</code></pre></div></div>

<h3 id="groupby-">GroupBy !</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eleve</th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Eleve0</td>
      <td>71.43</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Eleve1</td>
      <td>100.00</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Eleve4</td>
      <td>71.43</td>
      <td>Unknown</td>
      <td>td1</td>
    </tr>
  </tbody>
</table>
</div>

<p>Groupby applies the <strong><em>“split, apply, combine”</em></strong> method.</p>

<ul>
  <li>We first have to use a <code class="language-plaintext highlighter-rouge">key</code> to groupby, i.e. a column of different labels that will serve to <strong><em>split</em></strong> the main <code class="language-plaintext highlighter-rouge">df</code> into different subsets (one for each label in the concerned column), just as we would do a GROUP BY in SQL syntax.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'groupe'</span><span class="p">)</span> 
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x1187d9a90&gt;
</code></pre></div></div>

<p>No computation is done yet</p>

<p>This result in a DataFrameGroupBy object we can iterate on.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">name_group</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'groupe'</span><span class="p">):</span>
    <span class="c1"># the label used , the df subset (one for each label)
</span>    <span class="k">print</span><span class="p">(</span> <span class="s">"label used {}, dataframe shape {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">name_group</span><span class="p">,</span><span class="n">group</span><span class="p">.</span><span class="n">shape</span><span class="p">))</span> 
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>label used Unknown, dataframe shape (92, 4)
label used ibo1, dataframe shape (117, 4)
label used ibo2, dataframe shape (57, 4)
label used ibo3, dataframe shape (85, 4)
label used ibo4, dataframe shape (81, 4)
label used ibo5, dataframe shape (115, 4)
label used ibo6, dataframe shape (85, 4)
label used ibo7, dataframe shape (114, 4)
</code></pre></div></div>

<ul>
  <li>Notice that we are not limited by grouping over one column keys.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">name_group</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'groupe'</span><span class="p">,</span> <span class="s">"quizz"</span><span class="p">]):</span>
    <span class="c1"># the label used , the df subset (one for each label)
</span>    <span class="k">print</span><span class="p">(</span> <span class="s">"label used {}, dataframe shape {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">name_group</span><span class="p">,</span><span class="n">group</span><span class="p">.</span><span class="n">shape</span><span class="p">))</span> 
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>label used ('Unknown', 'td1'), dataframe shape (92, 4)
label used ('ibo1', 'td1'), dataframe shape (30, 4)
label used ('ibo1', 'td2'), dataframe shape (30, 4)
label used ('ibo1', 'td3'), dataframe shape (27, 4)
label used ('ibo1', 'td4'), dataframe shape (30, 4)
label used ('ibo2', 'td2'), dataframe shape (30, 4)
label used ('ibo2', 'td3'), dataframe shape (27, 4)
label used ('ibo3', 'td2'), dataframe shape (30, 4)
label used ('ibo3', 'td3'), dataframe shape (27, 4)
label used ('ibo3', 'td4'), dataframe shape (28, 4)
label used ('ibo4', 'td2'), dataframe shape (27, 4)
label used ('ibo4', 'td3'), dataframe shape (28, 4)
label used ('ibo4', 'td4'), dataframe shape (26, 4)
label used ('ibo5', 'td1'), dataframe shape (27, 4)
label used ('ibo5', 'td2'), dataframe shape (30, 4)
label used ('ibo5', 'td3'), dataframe shape (28, 4)
label used ('ibo5', 'td4'), dataframe shape (30, 4)
label used ('ibo6', 'td2'), dataframe shape (29, 4)
label used ('ibo6', 'td3'), dataframe shape (28, 4)
label used ('ibo6', 'td4'), dataframe shape (28, 4)
label used ('ibo7', 'td1'), dataframe shape (29, 4)
label used ('ibo7', 'td2'), dataframe shape (28, 4)
label used ('ibo7', 'td3'), dataframe shape (28, 4)
label used ('ibo7', 'td4'), dataframe shape (29, 4)
</code></pre></div></div>

<p>This results in a mutli-index with:</p>
<ul>
  <li>level0 = the group</li>
  <li>level1 = the quizz number</li>
</ul>

<p>We can also index the <code class="language-plaintext highlighter-rouge">GroupByDataFrame</code> object by retrieving one Series (again no computation is done yet)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'groupe'</span><span class="p">,</span> <span class="s">"quizz"</span><span class="p">])[</span><span class="s">"note"</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;pandas.core.groupby.generic.SeriesGroupBy object at 0x1188bdeb8&gt;
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">name_group</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'groupe'</span><span class="p">,</span> <span class="s">"quizz"</span><span class="p">])[</span><span class="s">"note"</span><span class="p">]:</span>
    <span class="k">print</span><span class="p">(</span> <span class="s">"label used {}, </span><span class="se">\n</span><span class="s">{} shape {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">name_group</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">group</span><span class="p">),</span> <span class="n">group</span><span class="p">.</span><span class="n">shape</span><span class="p">))</span> 
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>label used ('Unknown', 'td1'), 
&lt;class 'pandas.core.series.Series'&gt; shape (92,)
label used ('ibo1', 'td1'), 
&lt;class 'pandas.core.series.Series'&gt; shape (30,)
label used ('ibo1', 'td2'), 
&lt;class 'pandas.core.series.Series'&gt; shape (30,)
label used ('ibo1', 'td3'), 
&lt;class 'pandas.core.series.Series'&gt; shape (27,)
label used ('ibo1', 'td4'), 
&lt;class 'pandas.core.series.Series'&gt; shape (30,)
label used ('ibo2', 'td2'), 
&lt;class 'pandas.core.series.Series'&gt; shape (30,)
label used ('ibo2', 'td3'), 
&lt;class 'pandas.core.series.Series'&gt; shape (27,)
label used ('ibo3', 'td2'), 
&lt;class 'pandas.core.series.Series'&gt; shape (30,)
label used ('ibo3', 'td3'), 
&lt;class 'pandas.core.series.Series'&gt; shape (27,)
label used ('ibo3', 'td4'), 
&lt;class 'pandas.core.series.Series'&gt; shape (28,)
label used ('ibo4', 'td2'), 
&lt;class 'pandas.core.series.Series'&gt; shape (27,)
label used ('ibo4', 'td3'), 
&lt;class 'pandas.core.series.Series'&gt; shape (28,)
label used ('ibo4', 'td4'), 
&lt;class 'pandas.core.series.Series'&gt; shape (26,)
label used ('ibo5', 'td1'), 
&lt;class 'pandas.core.series.Series'&gt; shape (27,)
label used ('ibo5', 'td2'), 
&lt;class 'pandas.core.series.Series'&gt; shape (30,)
label used ('ibo5', 'td3'), 
&lt;class 'pandas.core.series.Series'&gt; shape (28,)
label used ('ibo5', 'td4'), 
&lt;class 'pandas.core.series.Series'&gt; shape (30,)
label used ('ibo6', 'td2'), 
&lt;class 'pandas.core.series.Series'&gt; shape (29,)
label used ('ibo6', 'td3'), 
&lt;class 'pandas.core.series.Series'&gt; shape (28,)
label used ('ibo6', 'td4'), 
&lt;class 'pandas.core.series.Series'&gt; shape (28,)
label used ('ibo7', 'td1'), 
&lt;class 'pandas.core.series.Series'&gt; shape (29,)
label used ('ibo7', 'td2'), 
&lt;class 'pandas.core.series.Series'&gt; shape (28,)
label used ('ibo7', 'td3'), 
&lt;class 'pandas.core.series.Series'&gt; shape (28,)
label used ('ibo7', 'td4'), 
&lt;class 'pandas.core.series.Series'&gt; shape (29,)
</code></pre></div></div>

<h4 id="aggregation-functions">Aggregation functions</h4>

<p>We can now think about the “apply, combine” part</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">dtypes</span> 
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>eleve      object
note      float64
groupe     object
quizz      object
dtype: object
</code></pre></div></div>

<p>Pandas provides us some functions to be applied on a dataframe or Series (.mean(), .sum(), .std(), .describe(), .min(), etc…), we can seemlessly append one of them to the GroupBy Object to operate <strong>on each of the subsets DataFrames/Series created on the split step</strong> (this is the <strong><em>apply</em></strong> step).</p>

<p>After applying the function to each split, a <strong><em>combined</em></strong> result is returned, in the form of a Series object or DataFrame.</p>

<p>Note that for those aggregating functions reduce the shape of the data e.g. summing or meaning on a Series result in a scalar (the sum or the mean), this will be operated over each Series groups from the <strong>split</strong> step.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'groupe'</span><span class="p">])[</span><span class="s">"note"</span><span class="p">].</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>groupe
Unknown    63.664022
ibo1       87.337607
ibo2       97.251053
ibo3       86.418824
ibo4       87.953580
ibo5       80.288957
ibo6       83.484000
ibo7       86.402456
Name: note, dtype: float64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'groupe'</span><span class="p">,</span> <span class="s">'quizz'</span><span class="p">])[</span><span class="s">"note"</span><span class="p">].</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>groupe   quizz
Unknown  td1      63.664022
ibo1     td1      67.618000
         td2      94.666667
         td3      90.739630
         td4      96.666333
ibo2     td2      98.666667
         td3      95.678148
ibo3     td2      88.666667
         td3      88.887037
         td4      81.630357
ibo4     td2      87.407407
         td3      87.500000
         td4      89.009231
ibo5     td1      53.967407
         td2      90.000000
         td3      90.475714
         td4      84.759667
ibo6     td2      90.344828
         td3      83.332857
         td4      76.529286
ibo7     td1      74.875517
         td2      85.714286
         td3      94.642500
         td4      90.637931
Name: note, dtype: float64
</code></pre></div></div>

<p>as we get a hierarchical index we can unstack to make use of the dimensionality brought by column indexesm</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">_</span><span class="p">.</span><span class="n">unstack</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th>quizz</th>
      <th>td1</th>
      <th>td2</th>
      <th>td3</th>
      <th>td4</th>
    </tr>
    <tr>
      <th>groupe</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Unknown</th>
      <td>63.664022</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ibo1</th>
      <td>67.618000</td>
      <td>94.666667</td>
      <td>90.739630</td>
      <td>96.666333</td>
    </tr>
    <tr>
      <th>ibo2</th>
      <td>NaN</td>
      <td>98.666667</td>
      <td>95.678148</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ibo3</th>
      <td>NaN</td>
      <td>88.666667</td>
      <td>88.887037</td>
      <td>81.630357</td>
    </tr>
    <tr>
      <th>ibo4</th>
      <td>NaN</td>
      <td>87.407407</td>
      <td>87.500000</td>
      <td>89.009231</td>
    </tr>
    <tr>
      <th>ibo5</th>
      <td>53.967407</td>
      <td>90.000000</td>
      <td>90.475714</td>
      <td>84.759667</td>
    </tr>
    <tr>
      <th>ibo6</th>
      <td>NaN</td>
      <td>90.344828</td>
      <td>83.332857</td>
      <td>76.529286</td>
    </tr>
    <tr>
      <th>ibo7</th>
      <td>74.875517</td>
      <td>85.714286</td>
      <td>94.642500</td>
      <td>90.637931</td>
    </tr>
  </tbody>
</table>
</div>

<p>Something is unusual? why is there <code class="language-plaintext highlighter-rouge">NaN</code>? some class groups should have grades for each quizz.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>eleve     0
note      0
groupe    0
quizz     0
dtype: int64
</code></pre></div></div>

<p>though all the data seems complete…</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">apply</span><span class="p">(</span><span class="nb">sum</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>eleve     0
note      0
groupe    0
quizz     0
dtype: int64
</code></pre></div></div>

<p>Notice the <code class="language-plaintext highlighter-rouge">Unknown</code> group, we should look more into this…</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">[</span><span class="n">df_notes</span><span class="p">.</span><span class="n">groupe</span> <span class="o">==</span> <span class="s">"Unknown"</span><span class="p">]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eleve</th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
      <th>appreciation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Eleve0</td>
      <td>71.43</td>
      <td>Unknown</td>
      <td>td1</td>
      <td>Ok</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Eleve1</td>
      <td>100.00</td>
      <td>Unknown</td>
      <td>td1</td>
      <td>Good</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Eleve4</td>
      <td>71.43</td>
      <td>Unknown</td>
      <td>td1</td>
      <td>Ok</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Eleve6</td>
      <td>42.86</td>
      <td>Unknown</td>
      <td>td1</td>
      <td>Bad</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eleve8</td>
      <td>57.14</td>
      <td>Unknown</td>
      <td>td1</td>
      <td>Ok</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Eleve202</td>
      <td>57.14</td>
      <td>Unknown</td>
      <td>td1</td>
      <td>Ok</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Eleve203</td>
      <td>57.14</td>
      <td>Unknown</td>
      <td>td1</td>
      <td>Ok</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Eleve204</td>
      <td>71.43</td>
      <td>Unknown</td>
      <td>td1</td>
      <td>Ok</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Eleve205</td>
      <td>42.86</td>
      <td>Unknown</td>
      <td>td1</td>
      <td>Bad</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Eleve207</td>
      <td>42.86</td>
      <td>Unknown</td>
      <td>td1</td>
      <td>Bad</td>
    </tr>
  </tbody>
</table>
<p>92 rows × 5 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">_</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>92
</code></pre></div></div>

<p>To apply multiple aggregate functions at once using a list of the functions you want to apply in aggregate</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'quizz'</span><span class="p">).</span><span class="n">agg</span><span class="p">({</span><span class="s">'note'</span><span class="p">:</span> <span class="p">[</span><span class="s">'max'</span><span class="p">,</span> <span class="nb">min</span><span class="p">]})</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">note</th>
    </tr>
    <tr>
      <th></th>
      <th>max</th>
      <th>min</th>
    </tr>
    <tr>
      <th>quizz</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>td1</th>
      <td>100.0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>td2</th>
      <td>100.0</td>
      <td>40.00</td>
    </tr>
    <tr>
      <th>td3</th>
      <td>100.0</td>
      <td>50.00</td>
    </tr>
    <tr>
      <th>td4</th>
      <td>100.0</td>
      <td>42.86</td>
    </tr>
  </tbody>
</table>
</div>

<p>this results in a multi column index</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">_</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MultiIndex([('note', 'max'),
            ('note', 'min')],
           )
</code></pre></div></div>

<p>Grouping by students, we may have more insight.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'eleve'</span><span class="p">).</span><span class="n">agg</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="c1"># applied on all columns (where the function can be used on) for each subset
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
    </tr>
    <tr>
      <th>eleve</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Eleve0</th>
      <td>[71.43, 80.0, 100.0]</td>
      <td>[Unknown, ibo2, ibo2]</td>
      <td>[td1, td2, td3]</td>
    </tr>
    <tr>
      <th>Eleve1</th>
      <td>[100.0, 100.0, 100.0]</td>
      <td>[Unknown, ibo2, ibo2]</td>
      <td>[td1, td2, td3]</td>
    </tr>
    <tr>
      <th>Eleve10</th>
      <td>[100.0, 100.0, 85.71, 71.43]</td>
      <td>[ibo7, ibo7, ibo7, ibo7]</td>
      <td>[td3, td2, td4, td1]</td>
    </tr>
    <tr>
      <th>Eleve100</th>
      <td>[100.0, 100.0, 100.0, 85.71]</td>
      <td>[ibo7, ibo7, ibo7, ibo7]</td>
      <td>[td3, td2, td4, td1]</td>
    </tr>
    <tr>
      <th>Eleve101</th>
      <td>[100.0, 100.0, 85.71, 100.0]</td>
      <td>[ibo7, ibo7, ibo7, ibo7]</td>
      <td>[td3, td2, td4, td1]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Eleve95</th>
      <td>[85.71, 100.0, 100.0]</td>
      <td>[Unknown, ibo2, ibo2]</td>
      <td>[td1, td2, td3]</td>
    </tr>
    <tr>
      <th>Eleve96</th>
      <td>[100.0, 100.0, 100.0, 42.86]</td>
      <td>[ibo1, ibo1, ibo1, ibo1]</td>
      <td>[td4, td3, td2, td1]</td>
    </tr>
    <tr>
      <th>Eleve97</th>
      <td>[28.57, 85.71, 83.33, 60.0]</td>
      <td>[Unknown, ibo4, ibo4, ibo4]</td>
      <td>[td1, td4, td3, td2]</td>
    </tr>
    <tr>
      <th>Eleve98</th>
      <td>[42.86, 85.71, 100.0, 100.0]</td>
      <td>[Unknown, ibo4, ibo4, ibo4]</td>
      <td>[td1, td4, td3, td2]</td>
    </tr>
    <tr>
      <th>Eleve99</th>
      <td>[71.43, 100.0, 100.0]</td>
      <td>[Unknown, ibo2, ibo2]</td>
      <td>[td1, td2, td3]</td>
    </tr>
  </tbody>
</table>
<p>208 rows × 3 columns</p>
</div>

<p>Some students are known, but are not always written as such.</p>

<h4 id="transform">transform</h4>

<p>sometimes we want the <strong><em>“apply-combine”</em></strong> steps to avoid reducing the data size but compute for each data record something based on some intra-group/splits caracteristics</p>

<p>Here we would want for example to group by students and replace <code class="language-plaintext highlighter-rouge">Unknown</code> fields by the correct information from the other students record.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eleve</th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Eleve0</td>
      <td>71.43</td>
      <td>ibo2</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Eleve1</td>
      <td>100.00</td>
      <td>ibo2</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Eleve4</td>
      <td>71.43</td>
      <td>ibo2</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Eleve6</td>
      <td>42.86</td>
      <td>ibo6</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eleve8</td>
      <td>57.14</td>
      <td>ibo4</td>
      <td>td1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>741</th>
      <td>Eleve174</td>
      <td>100.00</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>742</th>
      <td>Eleve166</td>
      <td>66.67</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>743</th>
      <td>Eleve176</td>
      <td>83.33</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>744</th>
      <td>Eleve186</td>
      <td>100.00</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
    <tr>
      <th>745</th>
      <td>Eleve196</td>
      <td>66.67</td>
      <td>ibo5</td>
      <td>td3</td>
    </tr>
  </tbody>
</table>
<p>746 rows × 4 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">replace</span><span class="p">({</span><span class="s">"Unknown"</span><span class="p">:</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">[</span><span class="s">"groupe"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'eleve'</span><span class="p">)[</span><span class="s">'groupe'</span><span class="p">].</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">bfill</span><span class="p">().</span><span class="n">ffill</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'eleve'</span><span class="p">).</span><span class="n">agg</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
      <th>appreciation</th>
    </tr>
    <tr>
      <th>eleve</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Eleve0</th>
      <td>[71.43, 80.0, 100.0]</td>
      <td>[ibo2, ibo2, ibo2]</td>
      <td>[td1, td2, td3]</td>
      <td>[Ok, Good, Good]</td>
    </tr>
    <tr>
      <th>Eleve1</th>
      <td>[100.0, 100.0, 100.0]</td>
      <td>[ibo2, ibo2, ibo2]</td>
      <td>[td1, td2, td3]</td>
      <td>[Good, Good, Good]</td>
    </tr>
    <tr>
      <th>Eleve10</th>
      <td>[100.0, 100.0, 85.71, 71.43]</td>
      <td>[ibo7, ibo7, ibo7, ibo7]</td>
      <td>[td3, td2, td4, td1]</td>
      <td>[Good, Good, Good, Ok]</td>
    </tr>
    <tr>
      <th>Eleve100</th>
      <td>[100.0, 100.0, 100.0, 85.71]</td>
      <td>[ibo7, ibo7, ibo7, ibo7]</td>
      <td>[td3, td2, td4, td1]</td>
      <td>[Good, Good, Good, Good]</td>
    </tr>
    <tr>
      <th>Eleve101</th>
      <td>[100.0, 100.0, 85.71, 100.0]</td>
      <td>[ibo7, ibo7, ibo7, ibo7]</td>
      <td>[td3, td2, td4, td1]</td>
      <td>[Good, Good, Good, Good]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Eleve95</th>
      <td>[85.71, 100.0, 100.0]</td>
      <td>[ibo2, ibo2, ibo2]</td>
      <td>[td1, td2, td3]</td>
      <td>[Good, Good, Good]</td>
    </tr>
    <tr>
      <th>Eleve96</th>
      <td>[100.0, 100.0, 100.0, 42.86]</td>
      <td>[ibo1, ibo1, ibo1, ibo1]</td>
      <td>[td4, td3, td2, td1]</td>
      <td>[Good, Good, Good, Bad]</td>
    </tr>
    <tr>
      <th>Eleve97</th>
      <td>[28.57, 85.71, 83.33, 60.0]</td>
      <td>[ibo4, ibo4, ibo4, ibo4]</td>
      <td>[td1, td4, td3, td2]</td>
      <td>[Bad, Good, Good, Ok]</td>
    </tr>
    <tr>
      <th>Eleve98</th>
      <td>[42.86, 85.71, 100.0, 100.0]</td>
      <td>[ibo4, ibo4, ibo4, ibo4]</td>
      <td>[td1, td4, td3, td2]</td>
      <td>[Bad, Good, Good, Good]</td>
    </tr>
    <tr>
      <th>Eleve99</th>
      <td>[71.43, 100.0, 100.0]</td>
      <td>[ibo2, ibo2, ibo2]</td>
      <td>[td1, td2, td3]</td>
      <td>[Ok, Good, Good]</td>
    </tr>
  </tbody>
</table>
<p>208 rows × 4 columns</p>
</div>

<p>Let’s check if we still have some NAs?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'groupe'</span><span class="p">,</span> <span class="s">'quizz'</span><span class="p">])[</span><span class="s">"note"</span><span class="p">].</span><span class="n">mean</span><span class="p">().</span><span class="n">unstack</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th>quizz</th>
      <th>td1</th>
      <th>td2</th>
      <th>td3</th>
      <th>td4</th>
    </tr>
    <tr>
      <th>groupe</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ibo1</th>
      <td>67.618000</td>
      <td>94.666667</td>
      <td>90.739630</td>
      <td>96.666333</td>
    </tr>
    <tr>
      <th>ibo2</th>
      <td>76.846207</td>
      <td>98.666667</td>
      <td>95.678148</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ibo3</th>
      <td>40.002000</td>
      <td>88.666667</td>
      <td>88.887037</td>
      <td>81.630357</td>
    </tr>
    <tr>
      <th>ibo4</th>
      <td>56.632500</td>
      <td>87.407407</td>
      <td>87.500000</td>
      <td>89.009231</td>
    </tr>
    <tr>
      <th>ibo5</th>
      <td>53.967407</td>
      <td>90.000000</td>
      <td>90.475714</td>
      <td>84.759667</td>
    </tr>
    <tr>
      <th>ibo6</th>
      <td>61.427667</td>
      <td>90.344828</td>
      <td>83.332857</td>
      <td>76.529286</td>
    </tr>
    <tr>
      <th>ibo7</th>
      <td>74.875517</td>
      <td>85.714286</td>
      <td>94.642500</td>
      <td>90.637931</td>
    </tr>
  </tbody>
</table>
</div>

<p>Seems better !</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">[(</span><span class="n">df_notes</span><span class="p">.</span><span class="n">groupe</span> <span class="o">==</span> <span class="s">'ibo2'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_notes</span><span class="p">.</span><span class="n">quizz</span> <span class="o">==</span> <span class="s">'td4'</span><span class="p">)]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eleve</th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<p>seems we don’t have data for the exam number 4 fro this group (which had been cancelled due too large manifestations in Paris which lead to postpone the session too late.)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span> <span class="o">=</span> <span class="n">df_notes</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">df_notes</span><span class="p">.</span><span class="n">quizz</span><span class="o">==</span><span class="s">'td4'</span><span class="p">)]</span>
</code></pre></div></div>

<h4 id="pivot-table">Pivot Table</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'groupe'</span><span class="p">,</span> <span class="s">'quizz'</span><span class="p">])[</span><span class="s">"note"</span><span class="p">].</span><span class="n">mean</span><span class="p">().</span><span class="n">unstack</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th>quizz</th>
      <th>td1</th>
      <th>td2</th>
      <th>td3</th>
    </tr>
    <tr>
      <th>groupe</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ibo1</th>
      <td>67.618000</td>
      <td>94.666667</td>
      <td>90.739630</td>
    </tr>
    <tr>
      <th>ibo2</th>
      <td>76.846207</td>
      <td>98.666667</td>
      <td>95.678148</td>
    </tr>
    <tr>
      <th>ibo3</th>
      <td>40.002000</td>
      <td>88.666667</td>
      <td>88.887037</td>
    </tr>
    <tr>
      <th>ibo4</th>
      <td>56.632500</td>
      <td>87.407407</td>
      <td>87.500000</td>
    </tr>
    <tr>
      <th>ibo5</th>
      <td>53.967407</td>
      <td>90.000000</td>
      <td>90.475714</td>
    </tr>
    <tr>
      <th>ibo6</th>
      <td>61.427667</td>
      <td>90.344828</td>
      <td>83.332857</td>
    </tr>
    <tr>
      <th>ibo7</th>
      <td>74.875517</td>
      <td>85.714286</td>
      <td>94.642500</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s">'note'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s">'groupe'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'quizz'</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th>quizz</th>
      <th>td1</th>
      <th>td2</th>
      <th>td3</th>
      <th>All</th>
    </tr>
    <tr>
      <th>groupe</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ibo1</th>
      <td>67.618000</td>
      <td>94.666667</td>
      <td>90.739630</td>
      <td>84.120805</td>
    </tr>
    <tr>
      <th>ibo2</th>
      <td>76.846207</td>
      <td>98.666667</td>
      <td>95.678148</td>
      <td>90.370349</td>
    </tr>
    <tr>
      <th>ibo3</th>
      <td>40.002000</td>
      <td>88.666667</td>
      <td>88.887037</td>
      <td>84.838065</td>
    </tr>
    <tr>
      <th>ibo4</th>
      <td>56.632500</td>
      <td>87.407407</td>
      <td>87.500000</td>
      <td>77.056747</td>
    </tr>
    <tr>
      <th>ibo5</th>
      <td>53.967407</td>
      <td>90.000000</td>
      <td>90.475714</td>
      <td>78.711059</td>
    </tr>
    <tr>
      <th>ibo6</th>
      <td>61.427667</td>
      <td>90.344828</td>
      <td>83.332857</td>
      <td>78.116667</td>
    </tr>
    <tr>
      <th>ibo7</th>
      <td>74.875517</td>
      <td>85.714286</td>
      <td>94.642500</td>
      <td>84.957412</td>
    </tr>
    <tr>
      <th>All</th>
      <td>64.686180</td>
      <td>90.882353</td>
      <td>90.154715</td>
      <td>82.528696</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">results</span> <span class="o">=</span> <span class="n">df_notes</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'groupe'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'quizz'</span><span class="p">,</span> 
                     <span class="n">aggfunc</span><span class="o">=</span><span class="p">{</span><span class="s">"note"</span><span class="p">:[</span><span class="s">'max'</span><span class="p">,</span> <span class="nb">min</span><span class="p">]})</span>
<span class="n">results</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr>
      <th></th>
      <th colspan="6" halign="left">note</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="3" halign="left">max</th>
      <th colspan="3" halign="left">min</th>
    </tr>
    <tr>
      <th>quizz</th>
      <th>td1</th>
      <th>td2</th>
      <th>td3</th>
      <th>td1</th>
      <th>td2</th>
      <th>td3</th>
    </tr>
    <tr>
      <th>groupe</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ibo1</th>
      <td>100.00</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>28.57</td>
      <td>80.0</td>
      <td>50.00</td>
    </tr>
    <tr>
      <th>ibo2</th>
      <td>100.00</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>42.86</td>
      <td>80.0</td>
      <td>83.33</td>
    </tr>
    <tr>
      <th>ibo3</th>
      <td>57.14</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>14.29</td>
      <td>40.0</td>
      <td>66.67</td>
    </tr>
    <tr>
      <th>ibo4</th>
      <td>100.00</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>0.00</td>
      <td>40.0</td>
      <td>66.67</td>
    </tr>
    <tr>
      <th>ibo5</th>
      <td>85.71</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>0.00</td>
      <td>60.0</td>
      <td>50.00</td>
    </tr>
    <tr>
      <th>ibo6</th>
      <td>100.00</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>28.57</td>
      <td>40.0</td>
      <td>50.00</td>
    </tr>
    <tr>
      <th>ibo7</th>
      <td>100.00</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>28.57</td>
      <td>40.0</td>
      <td>66.67</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">results</span><span class="p">[</span><span class="s">'note'</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11d11eba8&gt;
</code></pre></div></div>

<p><img src="/assets/images/post_discover_pandas/output_303_1.png" width="800px" style="display: inline-block;" class=".center" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'groupe'</span><span class="p">).</span><span class="n">appreciation</span><span class="p">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">sort_values</span><span class="p">().</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11ddc1cc0&gt;
</code></pre></div></div>

<p><img src="/assets/images/post_discover_pandas/output_304_1.png" width="800px" style="display: inline-block;" class=".center" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">df_notes</span><span class="p">.</span>
     <span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'quizz'</span><span class="p">,</span><span class="s">'groupe'</span><span class="p">])</span>
     <span class="p">[</span><span class="s">'appreciation'</span><span class="p">]</span>
     <span class="p">.</span><span class="n">value_counts</span><span class="p">().</span><span class="n">sort_index</span><span class="p">()</span>
     <span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11d1b4908&gt;
</code></pre></div></div>

<p><img src="/assets/images/post_discover_pandas/output_305_1.png" width="800px" style="display: inline-block;" class=".center" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">df_notes</span>
     <span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'quizz'</span><span class="p">,</span><span class="s">'groupe'</span><span class="p">])</span>
     <span class="p">[</span><span class="s">'appreciation'</span><span class="p">]</span>
     <span class="p">.</span><span class="n">value_counts</span><span class="p">()</span>
     <span class="p">.</span><span class="n">unstack</span><span class="p">().</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11ef2ff98&gt;
</code></pre></div></div>

<p><img src="/assets/images/post_discover_pandas/output_306_1.png" width="800px" style="display: inline-block;" class=".center" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">df_notes</span>
     <span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'quizz'</span><span class="p">,</span> 
                  <span class="n">columns</span><span class="o">=</span><span class="s">'groupe'</span><span class="p">,</span> 
                  <span class="n">aggfunc</span><span class="o">=</span><span class="p">{</span><span class="s">'appreciation'</span><span class="p">:</span><span class="s">'value_counts'</span><span class="p">})</span>
     <span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11ee1d7f0&gt;
</code></pre></div></div>

<p><img src="/assets/images/post_discover_pandas/output_307_1.png" width="800px" style="display: inline-block;" class=".center" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">.</span><span class="n">appreciation</span><span class="p">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11d5a9128&gt;
</code></pre></div></div>

<p><img src="/assets/images/post_discover_pandas/output_308_1.png" width="800px" style="display: inline-block;" class=".center" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_notes</span><span class="p">[</span><span class="n">pd</span><span class="p">.</span><span class="n">isna</span><span class="p">(</span><span class="n">df_notes</span><span class="p">.</span><span class="n">appreciation</span><span class="p">)]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="styledtable">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eleve</th>
      <th>note</th>
      <th>groupe</th>
      <th>quizz</th>
      <th>appreciation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>75</th>
      <td>Eleve183</td>
      <td>0.0</td>
      <td>ibo4</td>
      <td>td1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>525</th>
      <td>Eleve111</td>
      <td>0.0</td>
      <td>ibo5</td>
      <td>td1</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>missing grades for students.
Final question should be…<br />
What should we put in <code class="language-plaintext highlighter-rouge">fillna</code> for them 😉 ?</p>

<p>Just an interesting link on representation of the <a href="https://home.adelphi.edu/~siegfried/cs170/170l1.pdf">data</a></p>
